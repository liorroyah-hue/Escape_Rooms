תיעוד פרויקט גמר – בגרות 5 יח"ל במדעי המחשב
שם הפרויקט: Cyber Escape - חדר בריחה דיגיטלי מבוסס AI

1. מבוא ורעיון כללי
-------------------
האפליקציה "Cyber Escape" היא פלטפורמה לחדרי בריחה דיגיטליים המשלבת תוכן סטטי מתוך בסיס נתונים ותוכן דינמי הנוצר בזמן אמת באמצעות בינה מלאכותית (Gemini AI). הפרויקט נועד לספק חוויה משחקית אימרסיבית הכוללת חידות, סרטוני אווירה מיוטיוב, ואפקטים קוליים ופיזיים (רטט), תוך שמירה על עיצוב תעשייתי-טכנולוגי (Cyber Theme).

2. דרישות המערכת
----------------
2.1 דרישות פונקציונליות:
- ניהול משתמשים: הרשמה והתחברות מול בסיס נתונים בענן (Supabase).
- בחירת מסלול: אפשרות למשחק בחדרים קבועים מראש או יצירת משחק מותאם אישית ע"י AI.
- מנגנון משחק: הצגת 10 שלבים, בכל שלב 2 שאלות אמריקאיות.
- מולטימדיה: ניגון מוזיקת רקע משתנה, אפקטים קוליים וסרטוני יוטיוב לפני כל שלב.
- מדידת ביצועים: מעקב אחרי זמן פתרון של כל חדר ושמירת התוצאות הסופיות.

2.2 דרישות לא-פונקציונליות:
- חוויית משתמש (UI/UX): עיצוב Dark Mode מבוסס ConstraintLayout.
- אמינות: מנגנון Retry אוטומטי בעת עומס על ה-API (שגיאת 429).
- ביצועים: עבודה אסינכרונית (Multi-threading) כדי לא לחסום את ממשק המשתמש.

3. ארכיטקטורה ומבנה קוד
-----------------------
הפרויקט בנוי בתבנית MVVM (Model-View-ViewModel), המפרידה בין הלוגיקה העסקית לתצוגה:
- View (Activities/Fragments): אחראים אך ורק על הצגת הנתונים למשתמש.
- ViewModel: מנהל את הנתונים והמצב של המסך ומתקשר עם ה-Repository.
- Model: מייצג את ישויות הנתונים (User, Question, QuizData).
- Repository: אחראי על שליפת הנתונים (מ-Supabase או מ-Gemini API).

3.1 דפוסי עיצוב (Design Patterns):
- Singleton: מחלקת GameAudioManager ממומשת כ-Singleton להבטחת נגן יחיד בכל האפליקציה.
- Observer: שימוש ב-LiveData לעדכון אוטומטי של התצוגה בעת שינוי נתונים.

4. תיאור טכנולוגי
-----------------
4.1 בסיס נתונים - Supabase:
שימוש ב-Supabase (PostgreSQL) לאחסון משתמשי המערכת, שאלות המשחק הקבועות ותוצאות השחקנים. התקשורת מתבצעת באמצעות REST API וספריית OkHttp.

4.2 בינה מלאכותית - Gemini API:
האפליקציה משתמשת ב-Gemini 2.0 Flash ליצירת תוכן משחק. פותח מנגנון לניקוי ופירוק (Parsing) של JSON מורכב המכיל שאלות, תשובות ומזהי יוטיוב.

4.3 ניהול סאונד ורטט:
מחלקת ה-GameAudioManager מנהלת מוזיקת רקע אקראית, השהיית מוזיקה בעת השמעת אפקט (הצלחה/טעות) וחזרה אוטומטית, וכן מנגנון רטט (Haptic Feedback).

5. תיאור אלגוריתמי מעניין
-------------------------
מנגנון ה-Progress Bar הסגמנטלי: במסך בחירת המשחק, פותח אלגוריתם המדמה טעינת מערכת. הבר מתקדם בסגמנטים בכל 2 שניות. במצב AI, הבר מתקדם עד הסגמנט ה-9 וממתין לתשובת השרת. ברגע קבלת הנתונים, הבר קופץ ל-100% ומבצע מעבר מסך.

6. בדיקות תוכנה (Testing)
-------------------------
הפרויקט כולל בדיקות יחידה (Unit Tests) למודל הנתונים Questions ובדיקות אינטגרציה (Integration Tests) לזרימת המשחק ב-MainActivity באמצעות Robolectric ו-Espresso.

7. מודל הנתונים (ERD)
---------------------
מסד הנתונים מורכב מ-3 טבלאות עיקריות:
- User: מאחסנת פרטי משתמש (username, password).
- Questions: מאחסנת מאגר שאלות קבוע (level, question, answers, correct_answer).
- Game_Results: מאחסנת תוצאות סופיות (user_id, total_time, levels_completed).
הקשר בין User ל-Game_Results הוא קשר של יחיד-לרבים (One-to-Many).

8. הנדסת פרומפטים (Prompt Engineering)
--------------------------------------
כדי להבטיח קבלת נתונים יציבה מה-AI, השתמשתי בטכניקת "Role Prompting":
- הגדרת תפקיד: "אתה מעצב חדרי בריחה יצירתי".
- מגבלות פורמט: דרישה ל-JSON תקין בלבד ללא טקסט חופשי.
- אופטימיזציה: פיצול הבקשות לשתיים (שאלות בנפרד ומזהי וידאו בנפרד) כדי למנוע חריגה ממגבלות זיכרון וזמן תגובה.

9. אבטחת מידע ותקינות נתונים
----------------------------
- הסתרת מפתחות: שימוש בקובץ local.properties ו-BuildConfig כדי למנוע חשיפת מפתחות API ב-GitHub.
- ולידציה: אימות קלט בשדות ההרשמה והתחברות למניעת ערכים ריקים או שגויים.

10. נגישות ולוקליזציה (RTL)
---------------------------
האפליקציה הותאמה במיוחד לשפה העברית:
- שימוש ב-layoutDirection="rtl" בכל ה-Layouts העיקריים.
- יישור טקסט (ViewStart) והתאמת אייקונים לכיוון הכתיבה.
- ניהול מחרוזות באמצעות strings.xml לתמיכה בריבוי שפות בעתיד.

11. רפלקציה וסיכום אישי
-----------------------
האתגר הגדול ביותר בפרויקט היה סנכרון המדיה (סאונד ורטט) עם מצב המשחק והתמודדות עם שגיאות תקשורת (Rate Limiting). למדתי כיצד לבנות ארכיטקטורה יציבה שיודעת להתאושש משגיאות ולספק חוויית משתמש רציפה ומקצועית.
